<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test R√°pido - Charla IA</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background: #f0f2f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .test-button {
            background: #007cba;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
            width: 100%;
        }
        .test-button:hover {
            background: #005a87;
        }
        .result {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            border-left: 4px solid #007cba;
            min-height: 100px;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .success { color: green; }
        .error { color: red; }
        .warning { color: orange; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ Test R√°pido - Charla IA</h1>
        <p>Prueba r√°pida para verificar que todo funciona correctamente.</p>
        
        <button class="test-button" onclick="testProduction()">
            üåç Test Producci√≥n (InfinityFree)
        </button>
        
        <button class="test-button" onclick="testLocal()">
            üè† Test Local (XAMPP)
        </button>
        
        <button class="test-button" onclick="testCharlaIntegration()">
            üí¨ Test Integraci√≥n CharlaAI
        </button>
        
        <div id="results" class="result">Haz clic en un bot√≥n para ejecutar el test...</div>
    </div>

    <script>
        const resultsDiv = document.getElementById('results');
        
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const classes = { success: 'success', error: 'error', warning: 'warning' };
            resultsDiv.innerHTML += `[${timestamp}] <span class="${classes[type] || ''}">${message}</span>\n`;
        }

        async function testProduction() {
            resultsDiv.innerHTML = 'üåç Probando producci√≥n...\n\n';
            
            const urls = [
                'https://phprubensans.wuaze.com/status.php',
                'https://phprubensans.wuaze.com/api.php'
            ];

            for (const url of urls) {
                try {
                    log(`üîç Probando: ${url}`);
                    const response = await fetch(url);
                    const text = await response.text();
                    
                    if (text.includes('<script') || text.includes('toNumbers')) {
                        log(`‚ùå INTERCEPTADO por protecci√≥n: ${url}`, 'error');
                        log(`üìÑ Respuesta: ${text.substring(0, 100)}...`, 'warning');
                    } else if (response.ok) {
                        log(`‚úÖ OK: ${url}`, 'success');
                        log(`üìÑ Respuesta: ${text.substring(0, 100)}`, 'success');
                    } else {
                        log(`‚ùå Error ${response.status}: ${url}`, 'error');
                    }
                } catch (error) {
                    log(`‚ùå Error de conexi√≥n: ${error.message}`, 'error');
                }
                log('');
            }
        }

        async function testLocal() {
            resultsDiv.innerHTML = 'üè† Probando local...\n\n';
            
            const urls = [
                'http://localhost/MF0493_3/charla-backend/status.php',
                'http://localhost/MF0493_3/charla-backend/api.php'
            ];

            for (const url of urls) {
                try {
                    log(`üîç Probando: ${url}`);
                    const response = await fetch(url);
                    const text = await response.text();
                    
                    if (response.ok) {
                        log(`‚úÖ OK: ${url}`, 'success');
                        log(`üìÑ Respuesta: ${text.substring(0, 100)}`, 'success');
                    } else {
                        log(`‚ùå Error ${response.status}: ${url}`, 'error');
                    }
                } catch (error) {
                    log(`‚ùå Error: ${error.message}`, 'error');
                    if (error.message.includes('Failed to fetch')) {
                        log(`üí° ¬øXAMPP est√° funcionando?`, 'warning');
                    }
                }
                log('');
            }
        }

        function testCharlaIntegration() {
            resultsDiv.innerHTML = 'üí¨ Probando integraci√≥n CharlaAI...\n\n';
            
            // Verificar si CharlaAI est√° disponible
            if (typeof CharlaAI !== 'undefined') {
                log('‚úÖ Clase CharlaAI encontrada', 'success');
                
                try {
                    const charla = new CharlaAI();
                    log('‚úÖ CharlaAI inicializada correctamente', 'success');
                    log(`‚öôÔ∏è API URL configurada: ${charla.config.apiUrl}`, 'info');
                    
                    // Verificar elementos DOM
                    setTimeout(() => {
                        const button = document.querySelector('.charla-float-button');
                        const container = document.querySelector('.charla-container');
                        
                        if (button && container) {
                            log('‚úÖ Elementos DOM creados correctamente', 'success');
                            log('‚úÖ Sistema CharlaAI completamente funcional', 'success');
                        } else {
                            log('‚ùå Elementos DOM no encontrados', 'error');
                        }
                    }, 1000);
                    
                } catch (error) {
                    log(`‚ùå Error inicializando CharlaAI: ${error.message}`, 'error');
                }
            } else {
                log('‚ùå Clase CharlaAI no encontrada', 'error');
                log('üí° Carga charla.js en tu p√°gina HTML', 'warning');
                log('üí° Ejemplo: <script src="js/charla.js"></script>', 'warning');
            }
        }

        // Informaci√≥n inicial
        resultsDiv.innerHTML = `üéØ Test R√°pido Charla IA
üìÖ ${new Date().toLocaleString()}
üåê Ubicaci√≥n: ${window.location.href}

Usa los botones arriba para probar diferentes aspectos del sistema.

üí° GU√çA R√ÅPIDA:
- Test Producci√≥n: Verifica InfinityFree
- Test Local: Verifica XAMPP local  
- Test Integraci√≥n: Verifica JavaScript CharlaAI

¬°Selecciona una opci√≥n para comenzar!`;
    </script>
</body>
</html>
